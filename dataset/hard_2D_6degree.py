import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import BSpline

# Degree=5的knots和控制点
knots = [0,0,0,0,0,0,0,
        0.0227,0.0455,0.0682,0.0909,0.1136,0.1364,0.1591,0.1818,0.2045,0.2273,
        0.25,0.2727,0.2955,0.3182,0.3409,0.3636,0.3864,0.4091,0.4318,0.4545,
        0.4773,0.5,0.5227,0.5455,0.5682,0.5909,0.6136,0.6364,0.6591,0.6818,
        0.7045,0.7273,0.75,0.7727,0.7955,0.8182,0.8409,0.8636,0.8864,0.9091,
        0.9318,0.9545,0.9773,
        1,1,1,1,1,1,1]  # 尾部节点 (p+1)

control_points = [
    [0.900000, 0.500000, 0.000000, 1.000000],
    [0.844971, 0.694284, 0.000000, 1.000000],
    [0.703125, 0.835076, 0.000000, 1.000000],
    [0.512428, 0.887556, 0.000000, 1.000000],
    [0.322536, 0.840165, 0.000000, 1.000000],
    [0.181869, 0.707081, 0.000000, 1.000000],
    [0.125261, 0.524059, 0.000000, 1.000000],
    [0.165354, 0.338843, 0.000000, 1.000000],
    [0.289835, 0.198712, 0.000000, 1.000000],
    [0.465118, 0.138413, 0.000000, 1.000000],
    [0.645392, 0.171558, 0.000000, 1.000000],
    [0.784584, 0.287610, 0.000000, 1.000000],
    [0.848139, 0.455113, 0.000000, 1.000000],
    [0.821583, 0.630195, 0.000000, 1.000000],
    [0.713768, 0.768057, 0.000000, 1.000000],
    [0.554069, 0.834433, 0.000000, 1.000000],
    [0.384408, 0.814100, 0.000000, 1.000000],
    [0.248257, 0.714312, 0.000000, 1.000000],
    [0.179491, 0.562419, 0.000000, 1.000000],
    [0.193978, 0.398394, 0.000000, 1.000000],
    [0.285961, 0.264320, 0.000000, 1.000000],
    [0.430065, 0.193594, 0.000000, 1.000000],
    [0.588262, 0.202617, 0.000000, 1.000000],
    [0.719903, 0.287036, 0.000000, 1.000000],
    [0.792163, 0.423386, 0.000000, 1.000000],
    [0.788214, 0.575579, 0.000000, 1.000000],
    [0.711107, 0.704445, 0.000000, 1.000000],
    [0.582455, 0.777818, 0.000000, 1.000000],
    [0.436423, 0.778551, 0.000000, 1.000000],
    [0.310658, 0.708486, 0.000000, 1.000000],
    [0.236589, 0.587459, 0.000000, 1.000000],
    [0.231574, 0.447724, 0.000000, 1.000000],
    [0.294876, 0.325375, 0.000000, 1.000000],
    [0.408373, 0.251019, 0.000000, 1.000000],
    [0.541691, 0.242124, 0.000000, 1.000000],
    [0.660326, 0.298958, 0.000000, 1.000000],
    [0.734567, 0.405034, 0.000000, 1.000000],
    [0.746935, 0.531839, 0.000000, 1.000000],
    [0.696265, 0.646476, 0.000000, 1.000000],
    [0.597478, 0.720205, 0.000000, 1.000000],
    [0.477268, 0.735641, 0.000000, 1.000000],
    [0.366895, 0.690816, 0.000000, 1.000000],
    [0.294064, 0.599173, 0.000000, 1.000000],
    [0.275971, 0.485617, 0.000000, 1.000000],
    [0.315279, 0.379760, 0.000000, 1.000000],
    [0.399941, 0.308205, 0.000000, 1.000000],
    [0.506803, 0.287864, 0.000000, 1.000000],
    [0.607910, 0.321991, 0.000000, 1.000000],
    [0.677820, 0.399854, 0.000000, 1.000000],
    [0.700000, 0.500000, 0.000000, 1.000000]
]

print("Length of knots:", len(knots))
print("Shape of control_points:", np.array(control_points).shape)

# Degree 5 B-Spline曲线
degree = 6
spl = BSpline(knots, control_points, degree)

# 在[0, 1]区间内生成100个样本点
x_vals = np.linspace(0, 1, 1000)
y_vals = spl(x_vals)

# 绘制2D B-Spline曲线
plt.figure(figsize=(8, 6))

# 曲线
plt.plot(y_vals[:, 0], y_vals[:, 1], label="B-Spline Curve",color=(1/255, 84/255, 147/255), linewidth=3)
# 控制点
plt.scatter([p[0] for p in control_points], [p[1] for p in control_points], color=(201/255, 78/255, 101/255), s=30, label="Control Points",alpha=1)

# 绘制控制多边形
control_points_x = [p[0] for p in control_points]
control_points_y = [p[1] for p in control_points]
# plt.plot(control_points_x, control_points_y, 'r--', label="Control Polygon")  # 使用红色虚线表示控制多边形
plt.plot(control_points_x, control_points_y, color=(201/255, 78/255, 101/255), linestyle='-', linewidth=1.5, label="Control Polygon")

# plt.title("B-Spline Degree=5 in 2D")
plt.xlabel("X",fontsize=20)
plt.ylabel("Y",fontsize=20)
# plt.legend(fontsize=30)
plt.grid(True)
plt.show()

plt.savefig('hard_2D_6degree.pdf')